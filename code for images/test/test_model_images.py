# -*- coding: utf-8 -*-
"""test_model_images.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1RqFPJskDr7kHdqG9B6Zr-ddeNz_sdp6b
"""

import numpy as np
import cv2
from tensorflow.keras.models import load_model

# Function to load and preprocess images
def load_image(image_path):
    image = cv2.imread(image_path)
    image = cv2.resize(image, (224, 224))
    image = image.astype('float32') / 255.0  # Normalize
    return image

# Load your trained model
model = load_model('deepfake_detection_model_images.h5')

# Path to the image you want to test
image_path = "/content/WIN_20230520_00_57_33_Pro.jpg"

# Load and preprocess the image
image = load_image(image_path)
image = np.expand_dims(image, axis=0)  # Add batch dimension

# Make prediction
prediction = model.predict(image)

if prediction > 0.5:
    print("The image is a deepfake.")
else:
    print("The image is real.")